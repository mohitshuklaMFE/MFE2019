# Problem Set 1
Name: Mohit Shukla

## Question 1
Construct the value-weighted market return using CRSP data, replicating the market return time series available in Kenneth French website. Also calculate the equal-weighted market return, and the lagged total market capitalization. Your output should be from January 1926 to December 2018, at a monthly frequency.

Before calculating the portfolio time series, I conduct a series of data cleaning as part of my PS Q1 function. Next, I describe my data cleaning process and their respective assumptions:
*	Universe of stocks: Following Ken French procedure, I restrict the sample to common shares (share codes 10 and 11) and to securities traded in the New York Stock Exchange, American Stock Exchange, or the Nasdaq Stock Exchange (exchange codes 1, 2, and 3).
*	Market Capitalization calculation: I calculate the total market cap of the stocks on the given date by multiplying the Price of the stock with the shares outstanding. To get the market cap in millions, the product is divided by 1000 as the number of shares outstanding is in thousands. For dates where either Price or Shares Outstanding are missing, the rows are removed to prevent any distortion of data.
*	Missing returns: Wherever the returns are missing, it is either the month of listing, or the month where the stock is listed. In such case, the returns are set as 0.
*	Delisting return calculation: The delisting returns are available in the last month for a stock, and the missing values everywhere else is set as 0. Thus, the new return formula becomes:
rnew = (1+rDEL)*(1+rRET) - 1
*	Portfolio weights: The portfolio weights for Value-weighted return is taken as the market cap of the stock, divided by the sum total market capitalization of all the stocks as on that day.
*	Sample period: The sample period has been selected from Dec-1925 to Dec-2018, which allows me to generate lag Market Cap data from Jan-1926 onwards.
*	Index generation: For equal-weighted return, we had to take the mean of returns of all stocks on that date. For Value-weighted return, we need to multiply the return of a stock with the portfolio weights of the previous month.


## Question 2
Using the risk-free rate of return from French's website, report the following moments of the market excess returns for both time series (4 decimal digits): annualized return, annualized volatility, annualized Sharpe ratio, skewness, and excess kurtosis. Annualized values should be calculated geometrically. You should be comparing between July 1926 to December 2018, at a monthly frequency.

The summary statistics are in Table 1 below [this is just an example not the 1926-2018 sample replication]. I report the following  five statistics: annualized mean, annualized standard deviation, annualized sharpe ratio, skewness, and excess kurtosis. In Column 1, I report the statistics for the replicated value-weighted market portfolio of stocks calculated in the previous question. In Column 2, I report the statistics for the value-weighted market portfolio of stocks from Ken French's website.

Table1: Summary Statistics

Estimated FF Market Excess Return	Actual FF Market Excess Return

Mean	0.0735	0.0610

Volatility	0.2016	0.1848

Sharpe Ratio	0.3644	0.3303

Skewness	0.4915	0.2639

Excess Kurtosis	7.2314	7.8548

From question, we have a times series of value-weighted market returns, and have also imported the Fama French dataset for Excess Market return. I compute these statistics as follows: 
*	Sample period: Monthly from July 1926 to December 2018. 
*	Annualized Mean: We use the geometric mean here to calculate the average annualized return. The annualized mean here is given by

$\mu=12\left(\left(\prod_{i=1}^{N}\left(1+r_i\right)\right)^\frac{1}{N}-1\right)$

*	Annualized Standard Deviation: The annualized standard deviation is given by

\sigma=\sqrt{\frac{12}{N}\sum_{i=1}^{N}\left(r_i-\mu\right)^2}

*	Sharpe Ratio: The Annualized Sharpe Ratio is calculated as the ratio of annualized mean divided by the annualized standard deviation

SR=\frac{\mu}{\sigma}

*	Skewness: The Skewness of the portfolio is defined as the following. Please note that the skewness number here is not annualized.

* Skewness=\frac{1}{N}\frac{\sum_{i=1}^{N}\left(r_i-\mu\right)^3}{\sigma^3}

*	Excess Kurtosis: I calculate excess kurtosis from the monthly time series directly (no annualization, and no logs) using the full sample. 

Excess\ Kurtosis=\frac{1}{N}\frac{\sum_{i=1}^{N}\left(r_i-\mu\right)^4}{\sigma^4}\ -\ 3

The above values are slightly difference as the values generated by the analysis is not exact, and we look at the same in the next problem.

## Question 3

Report (up to 8 decimal digits) the correlation between your time series and French's time series, and the maximum absolute difference between the two time series. It is zero? If not, justify whether the difference is economically negligible or not. What are the reasons a nonzero difference? You should be comparing between July 1926 to December 2018, at a monthly frequency.

In Table 2 below [this is just an example not the 1926-2018 sample replication], I report the time-series correlation between the replicated value-weighted market portfolio of stocks and the value-weighted market portfolio of stocks from Ken French's website. I also report the maximum difference between the two series.

I limit the sample to be between July 1926 and December 2018.

Table2: Correlation and Maximum Difference

Correlation	0.9441431

Maximum Difference	0.1286462

The difference between the replicated portfolio and the one from French's website is not zero. One of the reasons the correlation is not perfect is due to the distortion caused by the months of listing and delisting, where the price data is not available and hence we have to choose whether or not to take the return for that month into account. Also, since the listing and delisting does not happen at the end of the month at all times, the prices, even if computable, would not be exact monthly return.
